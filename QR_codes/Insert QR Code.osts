{"version":"0.2.0","body":"async function main(workbook: ExcelScript.Workbook) {\n\n//Assign variables\nlet ws = workbook.getWorksheet(\"Sheet1\");\nlet QRURL = ws.getRange(\"C3\").getValue().toString();\nlet QRLocation = ws.getRange(\"C27:C33\");\n\n//Fetch the URL Request\nlet QRResponse = await fetch(QRURL);\n\n//Store response as ArrayBuffer (required for an image file).\nlet QRImageData = await QRResponse.arrayBuffer();\n\n//Convert image to base64\nlet uInt8Array = new Uint8Array(QRImageData);\nlet count = uInt8Array.length;\nlet charCodeArr = new Array(count) as string[];\nfor (let i = count; i >= 0; i--) {\n    charCodeArr[i] = String.fromCharCode(uInt8Array[i]);\n};\nlet QRBase64 = btoa(charCodeArr.join(''));\n\n//Delete the previous image\ntry {\n    ws.getShape(\"QRCodeScripts\").delete();\n} catch {};\n\n//Add image to worksheet\nlet QRShape = ws.addImage(QRBase64);\nQRShape.setName(\"QRCodeScripts\");\nQRShape.setTop(QRLocation.getTop());\nQRShape.setLeft(QRLocation.getLeft());\nQRShape.setHeight(QRLocation.getHeight());\nQRShape.setWidth(QRLocation.getHeight());\n\n}","description":"","parameterInfo":"{\"originalParameterOrder\":[],\"parameterSchema\":{\"type\":\"object\",\"default\":{},\"x-ms-visibility\":\"internal\"},\"returnSchema\":{\"type\":\"object\",\"properties\":{}}}","apiInfo":"{\"variant\":\"synchronous\",\"variantVersion\":2}"}